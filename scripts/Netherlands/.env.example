# Netherlands Scraper - Environment Configuration
# Copy this file to .env and customize as needed

# =========================================================
# BASE CONFIGURATION
# =========================================================
BASE_URL=https://www.medicijnkosten.nl
RUN_DATE=  # dd-mm-YYYY format, defaults to today

# =========================================================
# BROWSER SETTINGS
# =========================================================
HEADLESS_COLLECT=true       # Hide browser during URL collection
HEADLESS_SCRAPE=true        # Hide browser during scraping
PAGELOAD_TIMEOUT=90         # Page load timeout in seconds
DOM_READY_TIMEOUT=30        # DOM ready timeout in seconds

# =========================================================
# NETWORK RETRY CONFIGURATION
# =========================================================
NETWORK_RETRY_MAX=3                 # Maximum retry attempts for network errors
NETWORK_RETRY_DELAY=5               # Base delay in seconds (exponential backoff)
NETWORK_RETRY_MAX_WAIT_SEC=60       # Maximum wait time cap for exponential backoff
NETWORK_RETRY_JITTER_PERCENT=0.1    # Jitter percentage for retry delays (0.1 = 10%)

# =========================================================
# SAFETY LIMITS (INFINITE LOOP PREVENTION)
# =========================================================
ABSOLUTE_TIMEOUT_MINUTES=300        # Max time for scroll operations (5 hours)
MAX_WORKER_ITERATIONS=10000         # Max URLs a single worker can process
MAX_RETRY_PASSES=3                  # Max number of retry passes
MAX_DRIVER_RECREATIONS=10           # Max driver recreations per worker thread

# =========================================================
# SCROLL CONFIGURATION
# =========================================================
MIN_SCROLL_LOOPS=8000               # Minimum scroll loops before stability check
MAX_SCROLL_LOOPS=15000              # Maximum scroll loops (hard limit)
MAX_STUCK_ROUNDS=500                # Max rounds without progress before stopping
SCROLL_WAIT_MS=20                   # Wait time between scrolls in milliseconds
SAVE_URLS_EVERY_N_NEW=500           # Save URLs every N new URLs collected
SCROLL_PROGRESS_EVERY=250           # Print progress every N scroll loops
WORKER_PROGRESS_EVERY=100           # Print worker progress every N items

# =========================================================
# WORKER THREAD CONFIGURATION
# =========================================================
SCRAPE_THREADS=4                    # Number of parallel scraping threads
WORKER_QUEUE_TIMEOUT_SEC=5          # Queue timeout in seconds for workers

# =========================================================
# BEHAVIOR FLAGS
# =========================================================
SKIP_COMPLETED_PREFIXES=true        # Skip prefixes already completed
SKIP_IF_ALREADY_SCRAPED=true        # Skip URLs already scraped
REQUIRE_ID_FOR_SCRAPE=true          # Require ID in URL for scraping

# =========================================================
# RETRY SETTINGS
# =========================================================
MAX_RETRIES_PER_URL=1               # Max retries per URL
MAX_TOTAL_RETRIES=2                 # Max total retries across all passes
RETRY_BACKOFF_SECONDS=0             # Wait time after scraping (0 = no wait)
ENABLE_RETRY_PASS=false             # Enable retry pass for failed URLs

# =========================================================
# COLLECTION PERFORMANCE TUNING
# =========================================================
ANCHOR_WAIT_TIMEOUT=8.0             # Timeout for anchor element wait
ANCHOR_WAIT_TIMEOUT_EMPTY=2.0       # Timeout for empty anchor wait

# =========================================================
# DROPDOWN TOGGLE
# =========================================================
INLINE_DAYS_ID=inline-days          # ID for inline days dropdown
TOGGLE_TIMEOUT=15                   # Timeout for toggle operations
TOGGLE_SETTLE=0.35                  # Settle time after toggle change
PRICE_WAIT_TIMEOUT=10               # Wait for price to appear after toggle

# =========================================================
# DIRECT SINGLE-URL MODE
# =========================================================
NL_DIRECT_SEARCH_URL=               # Direct search URL (optional)
NL_STREAM_STABLE_ROUNDS=20          # Stable rounds before stopping in stream mode
NL_STREAM_SCROLL_WAIT_SEC=0.2       # Wait time between scrolls in stream mode

# =========================================================
# FINANCIAL SETTINGS
# =========================================================
VAT_RATE=0.09                       # VAT rate (9%)
CURRENCY=EUR                        # Currency code
MARGIN_RULE=632 Medicijnkosten Drugs4  # Margin rule description

# =========================================================
# BROWSER PROFILE CLEANUP
# =========================================================
CHROME_PROFILE_MAX_AGE_HOURS=24     # Max age of temp Chrome profiles before cleanup

# =========================================================
# COLLECTION MODE (CRITICAL FOR COMPLETE COVERAGE)
# =========================================================
# Use vorm/sterkte combinations instead of prefix-based collection
# IMPORTANT: The website limits results to ~5,000 per search
# - false (default): Prefix-based - INCOMPLETE (~5,000 products, missing ~17,000)
# - true: Combination-based - COMPLETE (22,000+ products)
# REQUIRES: Running 01_load_combinations.py first to populate combinations
# Default: false (for backward compatibility)
USE_DROPDOWN_COMBINATIONS=false

# =========================================================
# DATABASE CONFIGURATION
# =========================================================
# Database connection settings are typically in a separate config file
# See platform_config.py for database configuration
