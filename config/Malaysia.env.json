{
  "scraper": {
    "id": "Malaysia",
    "enabled": true
  },
  "config": {
    "_comment_general": "========== GENERAL SETTINGS ==========",

    "PIPELINE_LOG_FILE_PREFIX": "Malaysia_run_",

    "_comment_script_01": "========== SCRIPT 01: PRODUCT REGISTRATION NUMBER ==========",
    "_comment_script_01_desc": "Scrapes drug prices from MyPriMe website",

    "SCRIPT_01_URL": "https://pharmacy.moh.gov.my/ms/apps/drug-price",
    "SCRIPT_01_HEADLESS": "false",

    "SCRIPT_01_OUT_DIR": "../output",
    "SCRIPT_01_OUTPUT_CSV": "malaysia_drug_prices_view_all.csv",

    "SCRIPT_01_WAIT_TIMEOUT": 20,
    "SCRIPT_01_CLICK_DELAY": 2,

    "SCRIPT_01_CHROME_START_MAXIMIZED": "--start-maximized",
    "SCRIPT_01_CHROME_DISABLE_AUTOMATION": "--disable-blink-features=AutomationControlled",

    "SCRIPT_01_VIEW_ALL_XPATH": "//a[@href='javascript:sorter.showall()' or contains(translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'view all') or contains(translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'), 'lihat semua')]",
    "SCRIPT_01_TABLE_SELECTOR": "table.tinytable",
    "SCRIPT_01_HEADER_SELECTOR": "thead th",
    "SCRIPT_01_ROW_SELECTOR": "tbody tr",
    "SCRIPT_01_CELL_SELECTOR": "td",

    "_comment_script_02": "========== SCRIPT 02: PRODUCT DETAILS ==========",
    "_comment_script_02_desc": "Fetches detailed product information from Quest3Plus",

    "SCRIPT_02_SEARCH_URL": "https://quest3plus.bpfk.gov.my/pmo2/index.php",
    "SCRIPT_02_DETAIL_URL": "https://quest3plus.bpfk.gov.my/pmo2/detail.php?type=product&id={}",
    "SCRIPT_02_HEADLESS": false,

    "SCRIPT_02_BASE_DIR": "../",
    "SCRIPT_02_OUT_DIR": "output",
    "SCRIPT_02_INPUT_PRODUCTS": "products.csv",
    "SCRIPT_02_INPUT_MALAYSIA": "malaysia_drug_prices_view_all.csv",
    "SCRIPT_02_OUT_BULK": "quest3_bulk_results.csv",
    "SCRIPT_02_OUT_MISSING": "quest3_missing_regnos.csv",
    "SCRIPT_02_OUT_FINAL": "quest3_product_details.csv",
    "SCRIPT_02_REPORT_FILE": "quest3_product_details_report.txt",
    "SCRIPT_02_BULK_DIR_NAME": "bulk_search_csvs",
    "SCRIPT_02_BULK_CSV_PATTERN": "bulk_search_{index:03d}_{keyword}.csv",

    "SCRIPT_02_WAIT_BULK": 25,
    "SCRIPT_02_SEARCH_DELAY": 5,
    "SCRIPT_02_DETAIL_DELAY": 3,
    "SCRIPT_02_INDIVIDUAL_DELAY": 3,
    "SCRIPT_02_PAGE_TIMEOUT": 60000,
    "SCRIPT_02_SELECTOR_TIMEOUT": 30000,
    "SCRIPT_02_DATA_LOAD_WAIT": 3,
    "SCRIPT_02_SAVE_INTERVAL": 10,

    "SCRIPT_02_COVERAGE_HIGH_THRESHOLD": 95,
    "SCRIPT_02_COVERAGE_MEDIUM_THRESHOLD": 80,

    "SCRIPT_02_REGISTRATION_COLUMN": "Registration No / Notification No",
    "SCRIPT_02_SEARCH_BY_SELECTOR": "#searchBy",
    "SCRIPT_02_SEARCH_TXT_SELECTOR": "#searchTxt",
    "SCRIPT_02_SEARCH_BUTTON_SELECTOR": "button.btn-primary",
    "SCRIPT_02_RESULT_TABLE_SELECTOR": "table.table tbody tr",
    "SCRIPT_02_CSV_BUTTON_SELECTOR": "button.buttons-csv",
    "SCRIPT_02_DETAIL_TABLE_SELECTOR": "table.table tr",
    "SCRIPT_02_PRODUCT_NAME_LABEL": "product name :",
    "SCRIPT_02_HOLDER_LABEL": "holder :",
    "SCRIPT_02_HOLDER_ADDRESS_LABEL": "holder address",

    "_comment_script_03": "========== SCRIPT 03: CONSOLIDATE RESULTS ==========",
    "_comment_script_03_desc": "Combines product details from multiple sources",

    "SCRIPT_03_OUTPUT_BASE_DIR": "../output",
    "SCRIPT_03_QUEST3_DETAILS": "quest3_product_details.csv",
    "SCRIPT_03_CONSOLIDATED_FILE": "consolidated_products.csv",

    "SCRIPT_03_REQUIRED_COLUMNS": ["Registration No", "Product Name", "Holder"],
    "SCRIPT_03_OUTPUT_COLUMN_REGISTRATION": "Registration No / Notification No",

    "_comment_script_04": "========== SCRIPT 04: GET FULLY REIMBURSABLE ==========",
    "_comment_script_04_desc": "Scrapes fully reimbursable drugs from MOH website",

    "SCRIPT_04_BASE_URL": "https://pharmacy.moh.gov.my/ms/apps/fukkm",
    "SCRIPT_04_OUTPUT_DIR": "../output",
    "SCRIPT_04_OUT_CSV": "malaysia_fully_reimbursable_drugs.csv",

    "SCRIPT_04_REQUEST_TIMEOUT": 30,
    "SCRIPT_04_PAGE_DELAY": 0.04,
    "SCRIPT_04_FAIL_FAST": false,

    "SCRIPT_04_USER_AGENT": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
    "SCRIPT_04_ACCEPT_HEADER": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "SCRIPT_04_ACCEPT_LANGUAGE": "en-US,en;q=0.9",
    "SCRIPT_04_CONNECTION": "keep-alive",

    "SCRIPT_04_TABLE_SELECTOR": "table.views-table.cols-7",
    "SCRIPT_04_HEADER_SELECTOR": "thead th",
    "SCRIPT_04_FIRST_ROW_TH_SELECTOR": "tr th",
    "SCRIPT_04_TBODY_ROW_SELECTOR": "tbody tr",
    "SCRIPT_04_TR_SELECTOR": "tr",

    "_comment_script_05": "========== SCRIPT 05: GENERATE PCID MAPPED ==========",
    "_comment_script_05_desc": "Maps products to PCID and generates final output",

    "SCRIPT_05_BASE_DIR": "../",
    "SCRIPT_05_INPUT_DIR": "input",
    "SCRIPT_05_OUTPUT_DIR": "output",

    "SCRIPT_05_PCID_MAPPING": "Malaysia_PCID.csv",
    "SCRIPT_05_CONSOLIDATED": "consolidated_products.csv",
    "SCRIPT_05_PRICES": "malaysia_drug_prices_view_all.csv",
    "SCRIPT_05_REIMBURSABLE": "malaysia_fully_reimbursable_drugs.csv",
    "SCRIPT_05_OUT_MAPPED": "malaysia_pcid_mapped.csv",
    "SCRIPT_05_OUT_NOT_MAPPED": "malaysia_pcid_not_mapped.csv",
    "SCRIPT_05_COVERAGE_REPORT": "final_data_coverage_report.txt",

    "SCRIPT_05_COUNTRY_VALUE": "MALAYSIA",
    "SCRIPT_05_REGION_VALUE": "MALAYSIA",
    "SCRIPT_05_CURRENCY_VALUE": "MYR",
    "SCRIPT_05_SOURCE_VALUE": "PRICENTRIC",

    "SCRIPT_05_DEFAULT_VAT_PERCENT": 0.0,
    "SCRIPT_05_MISSING_PRODUCTS_REPORT_LIMIT": 20,
    "SCRIPT_05_PCID_COVERAGE_HIGH_THRESHOLD": 90,
    "SCRIPT_05_PCID_COVERAGE_MEDIUM_THRESHOLD": 70,

    "SCRIPT_05_SHEET_NAME_MAPPED": "Malaysia_PCID_Mapped",
    "SCRIPT_05_SHEET_NAME_NOT_MAPPED": "Malaysia_PCID_Not_Mapped",

    "SCRIPT_05_FINAL_COLUMNS": ["PCID Mapping", "Package Number", "Country", "Company", "Product Group", "Local Product Name", "Generic Name", "Description", "Indication", "Pack Size", "Effective Start Date", "Effective End Date", "Currency", "Ex Factory Wholesale Price", "Ex Factory Wholesale Price Less Rebate", "Ex Factory Hospital Price", "Ex Factory Hospital Price Less Rebate", "Ex Factory to Pharmacy Price", "Pharmacy Purchase Price", "Pharmacy Purchase Price Less Rebate", "Public without VAT Price", "Public Without VAT Price Less Rebate", "Public with VAT Price", "Public With VAT Price Less Rebate", "VAT Percent", "Reimbursable Status", "Reimbursable Price", "Reimbursable Rate", "Reimbursable Notes", "Copayment Value", "Copayment Percent", "Margin Rule", "Package Notes", "Discontinued", "Region", "WHO ATC Code", "Therapeutic Areas", "Presentation", "Marketing Authority", "Local Pack Description", "Formulation", "Fill Unit", "Fill Size", "Pack Unit", "Strength", "Strength Unit", "Brand Type", "Import Type", "Combination Molecule", "Source", "LOCAL_PACK_CODE", "Unit Price"],

    "_comment_script_00": "========== SCRIPT 00: BACKUP AND CLEAN ==========",
    "_comment_script_00_desc": "Manages output folder backup and cleanup",

    "SCRIPT_00_KEEP_FILES": [],
    "SCRIPT_00_KEEP_DIRS": ["runs", "backups"]
  },
  "secrets": {}
}
